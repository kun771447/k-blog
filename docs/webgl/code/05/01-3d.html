<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        // 归一化函数
        function normalized() {
            let sum = 0;
            for (let i = 0; i < arr.length; i++) {
                sum += arr[i] * arr[i];
            }

            const middle = Math.sqrt(sum);

            for (let i = 0; i < arr.length; i++) {
                arr[i] = arr[i] / middle;
            }
        }

        // 叉积函数 获取法向量
        function cross(a, b) {
            return new Float32Array([
                a[0] * b[1] - a[1] * b[0],
                a[1] * b[2] - a[2] * b[1],
                a[2] * b[0] - a[0] * b[2],
            ]);
        }

        // 点积函数 获取投影长度
        function dot(a, b) {
            return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];
        }

        // 向量差
        function minus(a, b) {
            return new Float32Array([
                a[0] - b[0],
                a[1] - b[1],
                a[2] - b[2],
            ]);
        }

        // 视图矩阵获取
        function getViewMatrix(eyex, eyey, eyez, lookAtx, lookAty, lookAtz, upx, upy, upz) {
            // 视点
            const eye = new Float32Array([eyex, eyey, eyez]);

            // 目标点
            const lookAt = new Float32Array([lookAtx, lookAty, lookAtz]);

            // 上方向
            const up = new Float32Array([upx, upy, upz]);

            // 确定 z 轴
            const z = minus(eye, lookAt);

            normalized(z);
            normalized(up);

            // 确定 x 轴
            const x = cross(z, up);

            normalized(x);

            // 确定 y 轴
            const y = cross(x, z);

            return new Float32Array([
                x[0],               y[0],           z[0],       0,
                x[1],               y[1],           z[1],       0,
                x[2],               y[2],           z[2],       0,
                -dot(x, eye), -dot(y, eye), -dot(z, eye),       1,
            ]);
        }
    </script>
</body>

</html>